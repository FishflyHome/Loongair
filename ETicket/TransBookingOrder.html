<!DOCTYPE html>
<html lang="en" xmlns:ng="http://angularjs.org" id="ng-app" ng-app="laAir">
<head>
    <meta charset="utf-8">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

    <meta http-equiv="expires" content="0">
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="Cache-control" content="no-cache, must-revalidate">
    <meta http-equiv="Cache" content="no-cache">

    <title></title>
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
    <meta name="format-detection" content="telephone=yes"/>
    <meta name="msapplication-tap-highlight" content="no"/>
    <meta name="keywords" content=""/>
    <meta name="description" content=""/>
    <link rel="canonical" href="http://www.loongair.cn/"/>

    <link rel='stylesheet' href='/Resource/style/style.css' type='text/css' media='all'>
    <link href="/Resource/images/cl.ico" rel="icon" type="image/x-icon"/>

    <![if !IE]>
    <script src="/Library/angular/angular1.4.8.min.js"></script>
    <script src="/Library/angular/angular-cookies1.4.8.min.js"></script>
    <![endif]>

    <!--[if gte IE 9]>
    <script src="/Library/angular/angular1.4.8.min.js"></script>
    <script src="/Library/angular/angular-cookies1.4.8.min.js"></script>
    <![endif]-->

    <!--[if lte IE 8]>
    <script src="/Library/angular/angular1.2.28.min.js"></script>
    <script src="/Library/angular/angular-cookies1.2.28.js"></script>
    <![endif]-->

    <!--[if lte IE 9]>
    <script src="/Library/others/Placeholders.js"></script>
    <![endif]-->

    <!--[if lt IE 9]>
    <script src="/Library/others/json2.js"></script>
    <![endif]-->

    <script src="/Service/entityClass/laEntityClass.js"></script>
    <script src="/Service/serviceImpl/laGlobalServiceImpl.js"></script>
    <script src="/Service/serviceImpl/laOrderServiceImpl.js"></script>
    <script src="/Service/serviceImpl/laUserServiceImpl.js"></script>
    <script src="/Service/serviceImpl/laAir.js"></script>

    <script type="text/javascript" src="/Library/others/jquery-1.10.1.min.js"></script>
    <script type="text/javascript" src="/Library/others/jquery.slide.js"></script>
    <script type="text/javascript" src="/Library/others/hDate.js"></script>
    <script type="text/javascript" src="/Library/others/bootbox.min.js"></script>
    <script type="text/javascript" src="/B2C/js/application.js"></script>
    <script type="text/javascript" src="/Library/others/Base64.js"></script>

    <script src="controller/TransBookingOrderCtl.js"></script>

    <style>
        .table-fli table {
            border-right: 1px solid #f5d2ba;
            border-bottom: 1px solid #f5d2ba;
            height: 60px;
        }

        .table-fli table td {
            border-left: 1px solid #f5d2ba;
            border-top: 1px solid #f5d2ba;
            background: #FFFFF0;
            text-align: center;
            vertical-align: middle
        }
    </style>
</head>
<body ng-controller="laAir_ETicket_TransBookingOrderPageCtl">
<div ng-include="'/Resource/commonHtml/header.html'"></div>

<div class="wrapper">
    <div class="container">
        <div class="panel panel-client">
            <div class="row">
                <div class="span9">
                    <div class="panel-sm">
                        <div class="table-fli" id="divfliinfo" style="display:none;" ng-show="flightInfo">
                            <h2 class="title-plane">{{otherInfo.sCity}} - {{otherInfo.eCity}}</h2>
                            <table style="width:100%;font-size:14px;">
                                <tr>
                                    <td>{{flightInfo.DepartureTime | date:'yyyy-MM-dd'}}<br>{{otherInfo.week}}</td>
                                    <td>航班号:{{flightInfo.FlightNum}}<br>机型:{{flightInfo.JiXing}}</td>
                                    <td>起飞:{{flightInfo.DepartureTime | date:'HH:mm'}}<br>到达:{{flightInfo.ArriveTime |
                                        date:'HH:mm'}}
                                    </td>
                                    <td>{{cabinInfo.CabinTypeName}}({{cabinInfo.CabinName}})</td>
                                    <td>
                                        <span ng-if="flightInfo.hasAdultPsg">票价(成人):<span style="color:orange">￥{{cabinInfo.SalePrice}}</span><br>机建/燃油(成人):￥{{flightInfo.AirportTax+flightInfo.FuelTax+flightInfo.OtherTax}}</span>
                                        <span ng-if="flightInfo.hasChildPsg"><br>票价(儿童):<span style="color:orange">￥{{childcabinInfo.SalePrice}}</span><br>机建/燃油(儿童):￥{{flightInfo.ChildAirportTax+flightInfo.ChildFuelTax+flightInfo.ChildOtherTax}}</span>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>

                    <div class="panel-sm">
                        <div ng-repeat="psg in passengerList track by $index">
                            <div class="panel-head">
                                <h2>第&nbsp;<strong>{{$index + 1}}</strong>&nbsp;位乘机人</h2>
                            </div>
                            <div class="panel-body clearfix">
                                <div class="control">
                                    <label><span style="color: red;">*</span>购票类型</label>
                                    <span>{{psg.TravellerTypeDisplay}}</span>
                                </div>
                                <div class="control">
                                    <label><span style="color: red;">*</span>乘客姓名</label>
                                    <span>{{psg.PassengerName}}</span>
                                </div>
                                <div class="control">
                                    <label><span style="color: red;">*</span>证件类型</label>
                                    <span>{{psg.FoidTypeDisplay}}</span>
                                </div>
                                <div class="control">
                                    <label><span style="color: red;">*</span>证件号码</label>
                                    <span>{{psg.Foid}}</span>
                                </div>
                                <div class="control">
                                    <label><span style="color: red;">*</span>出生日期</label>
                                    <span>{{psg.Brithday | date:'yyyy-MM-dd'}}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="panel-sm">
                        <div class="panel-head">
                            <h2>添加联系人信息</h2>
                        </div>
                        <div class="panel-body clearfix">
                            <div class="control">
                                <label><span style="color: red;">*</span>联系人</label>&nbsp;<input type="text" ng-model="cName" ng-blur="CheckConName();"/>
                                <div class="control" style="width:25%;"></div>
                                <div class="control" id="conName" style="width:75%; display:none;">
                                    <span class="error">请输入联系人姓名</span>
                                </div>
                            </div>
                            <div class="control">
                                <label><span style="color: red;">*</span>手机号码</label>&nbsp;<input type="text" ng-model="cMobile" ng-blur="CheckConMobile();"/>
                                <div class="control" style="width:25%;"></div>
                                <div class="control" id="conMobile" style="width:75%; display:none;">
                                    <span class="error">请输入11位格式正确的手机号码</span>
                                </div>
                            </div>
                            <div class="control">
                                <label><span style="color: red;">&nbsp;</span>联系电话</label>&nbsp;<input type="text" ng-model="cTel"/>
                            </div>
                            <div class="control">
                                <label><span style="color: red;">&nbsp;</span>电子邮箱</label>&nbsp;<input type="text" ng-model="cEmail"/>
                            </div>
                            <div class="control">
                                <label><span style="color: red;">&nbsp;</span>联系地址</label>&nbsp;<input type="text" ng-model="cAddr"/>
                            </div>
                            <div class="control">
                                <label><span style="color: red;">&nbsp;</span>邮政编码</label>&nbsp;<input type="text" ng-model="cZip"/>
                            </div>
                        </div>
                    </div>

                    <div class="submit">
                        <label class="checkbox inline"><input type="checkbox" name="dd" ng-model="acceptClause" checked><a href="/Travel/Transport/Rule.html" target="_blank">我已阅读并接受此票价的购票、旅行安全运输的相关条款</a></label>
                        <br><br>
                        <label class="pull-right" style="margin-left: 10px;margin-top: 10px;" ng-show="!CommitOrder">
                            <input type="text" class="text" style="width:80px;" placeholder="验证码" ng-model="verifyCode">&nbsp;&nbsp;
                            <a href="javascript:;" ng-click="btnChangeVerifyCode();" title="点击图片换一张">
                                <img ng-src="data:image/gif;base64,{{ImgVerifyCode}}" style="width:82px;height:32px;"></a>&nbsp;&nbsp;
                            <a class="link" href="javascript:;" ng-click="btnChangeVerifyCode();">换一张</a>
                        </label>
                        <label class="pull-right" style="line-height:60px;" ng-show="CommitOrder">
                            <img src="/Resource/images/loadingCircle.jpg" style="width:60px;height:60px;">
                            <span>正在提交订单...</span>
                        </label>
                        <a class="btn btn-large pull-right" href="javascript:;" ng-show="!CommitOrder"
                           ng-click="btnCommitOrderClick();">提交订单</a>
                    </div>
                </div>
                <div class="span3">
                    <div class="panel-sm">
                        <div class="m-cart" id="J_Cart">
                            <div class="route">
                                <div class="route-hd f-cb">
                                    <!--<i class="i-plane-g"></i>

                                    <h2 class="title-plane">长龙航空{{flightInfo.FlightNum}}</h2>-->
                                    <!--<a class="btn-abs" href="javascript:;" ng-click="btnBackForReQuery();">返回重选</a>-->
                                </div>
                                <!--
                                <div class="route-bd">
                                    <p class="f-cb"><em class="date">{{flightInfo.DepartureTime | date:'yyyy-MM-dd'}}</em><span>{{otherInfo.week}}</span></p>

                                    <p class="f-cb"><em class="time">{{flightInfo.DepartureTime | date:'HH:mm'}}</em><span>{{flightInfo.AirportFromCH}}</span></p>

                                    <p class="f-cb"><em class="time">{{flightInfo.ArriveTime | date:'HH:mm'}}</em><span>{{flightInfo.AirportToCH}}</span></p>
                                </div>
                                -->
                            </div>
                            <div id="divamountall" class="total" ng-show="passengerList.length>0" style="background-color: #E8D2C7; margin-bottom: 5px; margin-top: -5px; display: none;">
                                <div class="amount f-cb" ng-if="flightInfo.hasAdultPsg && !flightInfo.hasChildPsg">
                                    <span class="fl">合计</span> <b style="color:#E83828">&yen; {{passengerList.length *
                                    (cabinInfo.HandleAmount + cabinInfo.TicketPriceDiff + flightInfo.AirportTaxDiff + flightInfo.FuelTaxDiff)}}</b>
                                </div>
                                <div class="amount f-cb" ng-if="!flightInfo.hasAdultPsg && flightInfo.hasChildPsg">
                                    <span class="fl">合计</span> <b style="color:#E83828">&yen; {{passengerList.length *
                                    (cabinInfo.HandleAmount + cabinInfo.TicketPriceDiff + flightInfo.ChildAirportTaxDiff + flightInfo.ChildFuelTaxDiff)}}</b>
                                </div>
                                <div class="amount f-cb" ng-if="flightInfo.hasAdultPsg && flightInfo.hasChildPsg">
                                    <span class="fl">合计</span> <b style="color:#E83828">&yen; {{(passengerList | filter:{TravellerType:1}).length *
                                    (cabinInfo.HandleAmount + cabinInfo.TicketPriceDiff + flightInfo.AirportTaxDiff + flightInfo.FuelTaxDiff) +
                                    (passengerList | filter:{TravellerType:2}).length *
                                    (childcabinInfo.HandleAmount + childcabinInfo.TicketPriceDiff + flightInfo.ChildAirportTax + flightInfo.ChildFuelTax)}}</b>
                                </div>
                            </div>
                            <div id="divamountdetail" class="details" ng-show="passengerList.length>0" style="display:none;">
                                <div class="detail" ng-if="flightInfo.hasAdultPsg">
                                    <dl class="f-cb f-rmb">
                                        <dt>成人</dt>
                                        <dd>&nbsp;</dd>
                                    </dl>
                                    <dl class="f-cb f-rmb">
                                        <dt>机建/燃油（共）</dt>
                                        <dd style="color:#E83828">&yen; {{(passengerList | filter:{TravellerType:1}).length *
                                            (flightInfo.AirportTaxDiff + flightInfo.FuelTaxDiff)}}
                                        </dd>
                                    </dl>
                                    <dl class="f-cb f-rmb">
                                        <dt>手续费（共）</dt>
                                        <dd style="color:#E83828">&yen; {{(passengerList | filter:{TravellerType:1}).length * cabinInfo.HandleAmount}}
                                        </dd>
                                    </dl>
                                    <dl class="f-cb f-rmb">
                                        <dt>机票差价（共）</dt>
                                        <dd style="color:#E83828">&yen; {{(passengerList | filter:{TravellerType:1}).length * cabinInfo.TicketPriceDiff}}
                                        </dd>
                                    </dl>
                                </div>
                                <div class="detail" ng-if="flightInfo.hasChildPsg">
                                    <dl class="f-cb f-rmb">
                                        <dt>儿童</dt>
                                        <dd>&nbsp;</dd>
                                    </dl>
                                    <dl class="f-cb f-rmb">
                                        <dt>机建/燃油（共）</dt>
                                        <dd style="color:#E83828">&yen; {{(passengerList | filter:{TravellerType:2}).length *
                                            (flightInfo.ChildAirportTaxDiff + flightInfo.ChildFuelTaxDiff)}}
                                        </dd>
                                    </dl>
                                    <dl class="f-cb f-rmb">
                                        <dt>手续费（共）</dt>
                                        <dd style="color:#E83828">&yen; {{(passengerList | filter:{TravellerType:2}).length * childcabinInfo.HandleAmount}}
                                        </dd>
                                    </dl>
                                    <dl class="f-cb f-rmb">
                                        <dt>机票差价（共）</dt>
                                        <dd style="color:#E83828">&yen; {{(passengerList | filter:{TravellerType:2}).length * childcabinInfo.TicketPriceDiff}}
                                        </dd>
                                    </dl>
                                </div>

                                <div style="width:100%;">
                                    <input type="button"
                                           style="background:url(/Resource/images/btnbg.png) no-repeat; width:100%; height: 45px;border:none; font-size: 14px; color:white;cursor:pointer;"
                                           value="返回重选" ng-click="btnBackForReQuery();">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="divide"></div>
    </div>
</div>

<div ng-include="'/Resource/commonHtml/footer.html'"></div>

<div class="modal">
    <div class="vipmessage">
        <h2>常用旅客信息</h2>

        <div class="clip">
            <div class="control-group">
                <label class="control-label"><span style="color: red;">*</span>乘客类型:</label>

                <div class="controls">
                    <select id="cmbPtype" ng-model="Passenger.TravellerType" ng-options="t.v as t.t for t in psgTypeOptions">
                    </select>
                </div>
            </div>
            <div class="control-group">
                <label class="control-label"><span style="color: red;">*</span>姓名:</label>

                <div class="controls">
                    <input type="text" ng-model="Passenger.FlierName" ng-change="CheckFlierName();" placeholder="请输入姓名">
                    <input type="hidden"  ng-model="Passenger.Tid">
                    <span class="error" ng-show="!psgNameValid">请输入姓名</span>
                </div>
            </div>
            <div class="control-group">
                <label class="control-label"><span style="color: red;">*</span>证件类型:</label>

                <div class="controls">
                    <select id="cmbFtype" ng-model="Passenger.FoidType" ng-options="t.v as t.t for t in foIdTypeOptions">
                    </select>
                </div>
            </div>
            <div class="control-group">
                <label class="control-label"><span style="color: red;">*</span>证件号码:</label>

                <div class="controls">
                    <input type="text" ng-model="Passenger.Foid" ng-change="CheckFoid();" placeholder="请输入证件号码">
                    <span class="error" ng-show="!psgFoidValid">请输入正确的证件号码</span>
                </div>
            </div>
            <div class="control-group">
                <label class="control-label"><span style="color: red;">*</span>出生日期:</label>

                <div class="controls">
                    <input type="text" id="psgBirthday" placeholder="请输入出生日期(YYYY-MM-DD)" ng-change="CheckBirthday();" ng-model="Passenger.Brithday" onclick="javascript:calendar.show({id: this, minDay: '1900-1-1', ok: function () {}});">
                    <span class="error" ng-show="!psgBirthdayValid">请输入出生日期</span>
                </div>
            </div>
            <div class="control-group">
                <label class="control-label">手机号码:</label>

                <div class="controls">
                    <input type="text" ng-model="Passenger.Mobile" placeholder="请输入11位手机号码">
                    <span class="error" ng-show="!psgMobileValid">请输入11位手机号码</span>
                </div>
            </div>
            <div class="control-group">
                <label class="control-label">电子邮箱:</label>

                <div class="controls">
                    <input type="text" ng-model="Passenger.EMail" placeholder="请输入电子邮箱">
                    <span class="error" ng-show="!psgEMailValid">请输入格式正确的电子邮箱</span>
                </div>
            </div>
        </div>
    </div>
    <div class="vipmessage">
        <div class="vp-submit">
            <a class="btn pull-right" href="javascript:;" onclick="javascript:$('.modal').modal('hide');">关闭</a>
            <span class="pull-right">&nbsp;&nbsp;</span>
            <a class="btn pull-right" href="javascript:;" ng-click="btnAddMyPassengerClick();">添加</a>
        </div>
    </div>
</div>

<script language="JavaScript" type="text/javascript">
    $(document).on("mouseover mouseout","a.info",function(event){
        if(event.type == "mouseover"){
            $(this).find(".info-tips").show();
        }else if(event.type == "mouseout"){
            $(this).find(".info-tips").hide();
        }
    });
</script>

</body>
</html>